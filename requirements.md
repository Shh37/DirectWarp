# requirements.md

## アプリ概要

DirectWarp は、Google検索結果ページを介さず、AIが選定したURLに直接ジャンプするブラウザ拡張機能である。ユーザーの検索クエリに基づき、OpenAI、Google、AnthropicのAIプロバイダから最適なリンクを取得し、検索体験を高速化・最適化する。

## ターゲットプラットフォーム

- Chrome
- Firefox

## フレームワーク

- WXT

## 基本方針

1. 設定変更は次回の検索から反映されればよい（リアルタイム反映不要）
2. ユーザーがAIプロバイダを複数保存・切り替え可能
3. AIが返すURLはGoogleまたはBingの検索結果URLでもよい
4. URLが取得できない場合、ローディング画面にエラーメッセージを表示し、数秒後に検索画面に自動で戻る
5. APIキー保存時に有効性をチェックする
6. 検索クエリの履歴は保存しない（プライバシー重視）
7. ユーザーがAIプロバイダを選択すると、そのプロバイダ固有の設定項目だけを表示する
8. 「テスト」ボタンは設置しない。保存ボタン押下時に自動でバリデーション・エラーハンドリングする
9. APIキーの先頭が「!」である必要はない（先頭制約なし）

## アーキテクチャ構成

```
- manifest.json
- background/
  - background.ts
- content/
  - content.ts
- popup/
  - Popup.tsx
  - ProviderForm.tsx
  - ProviderList.tsx
- options/
  - Options.tsx
  - ThemeSelector.tsx
  - ProviderEditor.tsx
- lib/
  - apiClients/
    - openai.ts
    - anthropic.ts
    - google.ts
  - settings.ts
  - validator.ts
  - storage.ts
- styles/
  - tailwind.config.ts
  - globals.css
```

## 機能要件

### 1. 検索クエリの受け取りと処理

- Google検索ページ上で検索クエリを取得（contentスクリプト）
- バックグラウンド経由でAIプロバイダに送信
- レスポンスから最適URLを抽出し、自動ジャンプ

### 2. 設定画面

- 保存済みAIプロバイダ一覧の表示
- 新規追加・編集・削除
- 各プロバイダ固有の設定フォーム（APIキー、パラメータ）
- 現在有効なプロバイダの選択状態を表示
- 保存時にバリデーション＆APIキー有効性チェック（テストボタンは不要）

### 3. UI/UX

- ダークモード / ライトモードの切り替え対応
- アクセントカラーは暗めの淡い青
- 最小限のUI
  - メニュー（設定、現在のプロバイダ）
  - 保存ボタン（バリデーション結果によってエラー表示）
- ローディングUIあり
  - AI応答待機中にスピナー表示
  - 失敗時にはエラーメッセージ表示 + 数秒後に検索画面へ戻る

## 非機能要件

- APIキーなどの設定はローカル保存のみ（クラウドバックアップ不要）
- バックアップ・インポート機能あり（ファイル入出力）
- 検索クエリ履歴は保存しない

## テーマ・デザイン

- ダーク / ライトテーマ対応
- アクセントカラー：暗めの淡い青（例：#4A90E2）
- Tailwind CSS 使用
- UI構成：シンプル・ミニマル・コンパクト

## バリデーション

- APIキー形式チェック（先頭「!」制限なし）
- プロバイダごとに設定項目が異なるため、条件分岐して検証
- 保存時にネットワーク経由で有効性チェック（失敗時はエラー表示）

## 将来的な拡張予定（MVP範囲外）

- 検索対象の言語や地域指定
- 他の検索エンジン対応（Yahoo、DuckDuckGoなど）
- GPT-4 などモデルの選択肢
- ページ内のキーワード抽出による文脈強化
- クエリテンプレートの作成

## ライセンス・公開

- オープンソース（GitHub）
- Chrome Web Store および Firefox Add-ons に公開予定